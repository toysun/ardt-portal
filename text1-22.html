<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A-Frame test component Component - Basic</title>
    <meta
      name="description"
      content="Basic example for troika-text component."
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="aframe-troika-text.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const list = [
          "glasses1",
          "glasses2",
          "hat1",
          "hat2",
          "helmet",
          "helmet2",
        ];
        const visibles = [true, true, true, true, true, true];
        const setVisible = (button, entities, visible) => {
          if (visible) {
            button.classList.add("selected");
          } else {
            button.classList.remove("selected");
          }
          entities.forEach((entity) => {
            entity.setAttribute("visible", visible);
          });
        };
        list.forEach((item, index) => {
          const button = document.querySelector("#" + item);
          const entities = document.querySelectorAll("." + item + "-entity");
          setVisible(button, entities, visibles[index]);
          button.addEventListener("click", () => {
            visibles[index] = !visibles[index];
            setVisible(button, entities, visibles[index]);
          });
        });
      });
    </script>
    <script>
      AFRAME.registerComponent("my-test-component", {
        tick: function () {
          var el = this.el;
          el.setAttribute("text", { value: "" });
        },
      });

      function ee() {
        document
          .getElementById("output")
          .setAttribute("value", document.getElementById("fname").value);
      }
    </script>
    <script>
      // You can set the input as you want
      var inputeditable =
        '<textarea contenteditable="true" type="text" name="" class="input">';

      // For each DOM element that has .inputeditable, we add a click event, using inputeditableEnabled(). Which can be used anywhere
      $(".inputeditable").each(function () {
        inputeditableEnabled($(this));
      });

      // This function store the HTML, add child with input. When input lose focus, we push back the value of the input,
      // el is the dom object edited
      function inputeditableEnabled(el) {
        var contentWidth = el.width();
        var contentHeight = el.height();
        el.click(function () {
          var content = el.html().replace(/\n/g, "");
          el.html("").append(inputeditable);
          el.off("click");
          el.width(contentWidth).height(contentHeight);
          el.find(".input").val(content).focus();
          autosize(el.find(".input"));
          el.find(".input").focusout(function () {
            inputeditableDisabled(el, $(this));
          });
        });
      }

      // This function disable the edition of input. It change back the html of .inputeditable to plain text and remove the input
      // ,el is the editable dom object that need to be disabled
      // ,elInput is the input of said object
      function inputeditableDisabled(el, elInput) {
        if (!elInput) {
          elInput = el.find(".input");
        }
        var inputval = elInput.val();
        el.html(inputval);
        el.css({ width: "", height: "auto" });
        inputeditableEnabled(el);
      }

      // Every piece of code can be minified, but I chose not to, for editing purposes.
      // we use autoresize.js but it is not necessary if you have your own textarea resize. You can find the script here https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js
      // if you want the text to be inline, use an input, no textarea
    </script>
    <script>
 var modal = document.querySelector(".modal");
var trigger = document.querySelector(".trigger");
var closeButton = document.querySelector(".close-button");

function toggleModal() {
    modal.classList.toggle("show-modal");
}

function windowOnClick(event) {
    if (event.target === modal) {
        toggleModal();
    }
}

trigger.addEventListener("click", toggleModal);
closeButton.addEventListener("click", toggleModal);
window.addEventListener("click", windowOnClick);

    </script>
    <script>
    $('.btn_popup').click(function(){
  $('.ly_wrap').show();
})

$('.btn_close').click(function(){
  $('.ly_wrap').hide();
})
    </script>
    <style>
/* reset */
body,p,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dt,dd,table,th,td,form,fieldset,legend,input,textarea,button,select{margin:0;padding:0} 
body,input,textarea,select,button,table{font-family:ng,'Malgun Gothic','맑은고딕','Apple SD Gothic Neo',Dotum,'돋음',sans-serif;font-size:14px;color:#282828;line-height:1;letter-spacing:-.5px;word-break:break-all} 
img,fieldset{border:0} 
ul,ol{list-style:none} 
em,address{font-style:normal} 
a{text-decoration:none} 
a:hover,a:active,a:focus{text-decoration:none}
table{width:100%;/*border-collapse:collapse;*/border-spacing:0}
label{vertical-align:middle}
textarea{resize:none}
fieldset,li,img{border:0;vertical-align:top}
address,caption,em{font-style:normal}
h1,h2,h3,h4,h5,h6{font-weight:normal}
button{overflow:visible;border:0;/*outline:none;*/background-color:transparent;cursor:pointer}
button::-moz-focus-inner{padding:0;border:0}
.blind,legend{overflow:hidden;position:absolute;top:0;left:0;width:1px;height:1px;font-size:1px;
line-height:100px;white-space:nowrap}
/* reset */

.btn_com{background-color:#256b9a;color:#fff;}
.ly_wrap{z-index:50;position:fixed;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,0.8);}
.ly_box{position:absolute;top:50%;left:50%;width:300px;padding:50px 20px 20px;background-color:#fff;background-size: cover;
      background-image: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-1.png?v=1670487397403");transform:translate(-50%,-50%);text-align:center;}
.ly_box p{font-size:20px;}
.ly_box .btn_close{width:100px;height:50px;margin-top:30px;background-color:#256b9a;}
.btn_popup{padding:20px;}
textarea {
  margin-top: 10px;
  margin-left: 0px;
  width: 280px;
  height: 300px;
  -moz-border-bottom-colors: none;
  -moz-border-left-colors: none;
  -moz-border-right-colors: none;
  -moz-border-top-colors: none;
  background: none repeat scroll 0 0 rgba(0, 0, 0, 0.07);
  border-color: -moz-use-text-color #FFFFFF #FFFFFF -moz-use-text-color;
  border-image: none;
  border-radius: 6px 6px 6px 6px;
  border-style: none solid solid none;
  border-width: medium 1px 1px medium;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12) inset;
  color: #555555;
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size: 1em;
  line-height: 1.4em;
  padding: 5px 8px;
  transition: background-color 0.2s ease 0s;
}


textarea:focus {
    background: none repeat scroll 0 0 #FFFFFF;
    outline-width: 0;
}
    </style>
  </head>
  <body>
<button type="button" class="btn_popup btn_com">레이어 팝업 열기</button>
<div class="ly_wrap" style="display:none">
  <div class="ly_box">
    <p><textarea placeholder="여기에 사연을 적으세요." rows="20" name="comment[text]" id="comment_text" cols="40" class="ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true"></textarea></p>
    <p> <button type="button" onclick="ee()" class="btn_close btn_com"><h3>글쓰기</h3></button></p>   
  </div>
</div>
    <a-scene
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
      arjs
    >
      <!--a-entity
          id="scene1"
          scale="5 5 5"
          position="0 2 -1"
          rotation="0 0 0"
          gltf-model="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/bat-cute.glb?v=1658986652419"
          shadow="receive: true"
          animation-mixer
          gesture-handler
          animation="property: rotation; dur: 10000;
                       to: 0 360 0; loop: true"
          animation__2="property: position; dur: 15000;
                       to: -1.5 1.7 -10; loop: false"
          class="clickable"
          event-set__enter="_event: mousedown"
          navigate-on-click="url: https://www.baeulang.kr"
        >
        </a-entity-->
      <a-assets>
        <a-asset-item
          id="headModel"
          src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/examples/face-tracking/assets/sparkar/headOccluder.glb"
        ></a-asset-item>

        <a-asset-item
          id="glassesModel"
          src="https://cdn.glitch.me/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/tropical-fishes.glb?v=1658122336365"
        ></a-asset-item>
        <a-asset-item
          id="glassesModel2"
          src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/beating_heart%20(1).glb?v=1670511696120"
        ></a-asset-item>

        <a-asset-item
          id="hatModel"
          src="https://cdn.glitch.global/84219226-bfa8-4881-9a68-88e43606a2ce/confettiv2.glb?v=1668304368875"
        ></a-asset-item>

        <a-asset-item
          id="hatModel2"
          src="https://cdn.glitch.me/84219226-bfa8-4881-9a68-88e43606a2ce/ginger_cookie_shrek.glb?v=1669712200575"
        ></a-asset-item>
        <a-asset-item
          id="whale"
          src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/blue-whale.glb?v=1661216831738"
        ></a-asset-item>
        <a-asset-item
          id="helmetModel"
          src="https://cdn.glitch.global/84219226-bfa8-4881-9a68-88e43606a2ce/candy_cane%20(3).glb?v=1669712123697"
        ></a-asset-item>
        <a-asset-item
          id="helmetModel2"
          src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/love_neon_sign_-_wall.glb?v=1670512066611"
        ></a-asset-item>
      </a-assets>
      <a-camera active="false" position="0 1.6 -3"></a-camera>
      <!--a-entity>
            <a-gltf-model
              mindar-face-occluder
              position="0 -0.3 0.15"
              rotation="0 0 0"
              scale="0.065 0.065 0.065"
              src="#headModel"
            ></a-gltf-model>
          </a-entity-->

      <!--a-entity mindar-face-target="anchorIndex: 10">
          <a-gltf-model
            rotation="0 -180 0"
            position="0 -0.35 -0.6"
            scale="0.00073 0.00073 0.00073"
            src="#hatModel"
            class="hat1-entity"
            visible="false"
          ></a-gltf-model>
        </a-entity-->
      <a-entity>
        <a-gltf-model
          rotation="0 0 0"
          position="0 -0.35 -5.6"
          scale="2.7 2.7 2.7"
          src="#hatModel"
          class="hat1-entity"
          visible="false"
          animation-mixer
        ></a-gltf-model>
      </a-entity>
      <!--a-entity mindar-face-target="anchorIndex: 10">
          <a-gltf-model
            rotation="0 -180 0"
            position="0 -0.35 -0.6"
            scale="0.00073 0.00073 0.00073"
            src="#hatModel2"
            class="hat2-entity"
            visible="false"
          ></a-gltf-model>
         </a-entity-->
      <a-entity>
        <a-gltf-model
          rotation="0 -20 0"
          position="0.7 2.2 -2"
          scale="0.1 0.1 0.1"
          src="#hatModel2"
          class="hat2-entity"
          visible="false"
          animation-mixer
          animation="property: position; to: 0.7 2.1 -2; dur: 8000; easing: linear; loop: true"
        ></a-gltf-model>
      </a-entity>

      <a-entity>
        <a-gltf-model
          rotation="0 -0 0"
          position="0 1.8 -3.1"
          scale="0.75 0.75 0.75"
          src="#glassesModel"
          class="glasses1-entity"
          visible="false"
          animation-mixer
        ></a-gltf-model>
      </a-entity>

      <a-entity>
        <a-gltf-model
          rotation="0 0 0"
          position="-0.7 2.1 -2"
          scale="0.2 0.2 0.2"
          src="#glassesModel2"
          class="glasses2-entity"
          visible="false"
          animation-mixer
        ></a-gltf-model>
      </a-entity>

      <a-entity>
        <a-gltf-model
          rotation="0 90 0"
          position="-0.5 0.8 -2"
          scale="0 0 0"
          src="#helmetModel"
          class="helmet-entity"
          visible="false"
          animation-mixer
          animation="property: position; to: -0.6 0.9 -2; dur: 3000; easing: linear; loop: false"
          animation__2="property:scale; to: 0.0002 0.0002 0.0002; dur: 3000; easing: linear; loop: false"
        ></a-gltf-model>
      </a-entity>

      <a-entity>
        <a-gltf-model
          rotation="0 40 0"
          position="1 0.6 -2.5"
          scale="0.9 0.9 0.9"
          src="#helmetModel2"
          class="helmet2-entity"
          visible="false"
          animation-mixer
          animation="property: position; to: 1 0.7 -2.5; dur: 3000; easing: linear; loop: false"
        ></a-gltf-model>
      </a-entity>

      <a-entity>
        <a-troika-text
          id="output"
          position="0 1.9 -3.8"
          color="#000"
          max-width="15"
          curve-radius="0"
          scale="0 0 0"
          font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/KOTRA_SONGEULSSI.ttf?v=1670540917006"
          value="디즈니100주년 기념"
          animation="property: scale; to: 0.6 0.6 0.6; delay: 2000; dur: 5000; easing: linear; loop: false"
          animation__2="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
        ></a-troika-text>

        <!--a-troika-text
              position="0 1.3 -4"
              color="#000"
              max-width="7"
              curve-radius="0"
              scale="0.5 0.5 0.5"
              font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/Ghanachocolate.ttf?v=1658802278705"
              value="클릭하면 오디오가이드를 들을 수 있습니다."
            ></a-troika-text-->
        <a-plane
          position="0 1.7 -4.1"
          height="2.55"
          width="3.1"
          curve-radius="0"
          rotation="0 0 0"
          animation="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
        ></a-plane>
        <a-plane
          position="0 1.7 -4"
          height="2.45"
          width="2.95"
          curve-radius="0"
          color="#E64C3C"
          rotation="0 0 0"
          material="src: https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-1.png?v=1670487397403; color: #ffffff; roughness: 1; metalness: 0"
          animation="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
        ></a-plane>
      </a-entity>

      <a-entity
        text="value: some text; wrapCount: 20; width: 3"
        position="0 2 0"
        my-test-component
      ></a-entity>

      <!--<a-text
        position="0 1.1 -2"
        value="Hello a-text for comparison!"
      ></a-text>
<a-camera active="false" position="0 1.6 -3"></a-camera>
          <!--a-light type="ambient" intensity="3.3"></a-light-->
    </a-scene>
  </body>
</html>
