<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>디즈니 100주년 기념</title>
    <meta
      name="description"
      content="Basic example for troika-text component."
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="aframe-troika-text.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
    <!--script src="jquery-3.3.1.js"></script-->
    <!--script src="font-awesome-5.13.0.js"></script-->
    <script src="merge-image.js"></script>
    <link rel="stylesheet" href="style-capture-t.css" />

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const list = [
          "glasses1",
          "glasses2",
          "hat1",
          "hat2",
          "helmet",
          "helmet2",
        ];
        const visibles = [false, false, false, false, false, false];
        const setVisible = (button, entities, visible) => {
          if (visible) {
            button.classList.add("selected");
          } else {
            button.classList.remove("selected");
          }
          entities.forEach((entity) => {
            entity.setAttribute("visible", visible);
          });
        };
        list.forEach((item, index) => {
          const button = document.querySelector("#" + item);
          const entities = document.querySelectorAll("." + item + "-entity");
          setVisible(button, entities, visibles[index]);
          button.addEventListener("click", () => {
            visibles[index] = !visibles[index];
            setVisible(button, entities, visibles[index]);
          });
        });
      });
    </script>
    <script>
    /*  AFRAME.registerComponent("my-test-component", {
        tick: function () {
          var el = this.el;
          el.setAttribute("text", { value: "" });
        },
      }); */

      function ee() {
        document
          .getElementById("output")
          .setAttribute("value", document.getElementById("fname").value);
         document
          .getElementById("MsgZone").style.display="none";
        $('.DecoButton').show();
        $('.capturebtn').show();    
        $('.WriteButton').show(); 
      }
    </script>
    <script>
      // You can set the input as you want
      var inputeditable =
        '<textarea contenteditable="true" type="text" name="" class="input">';

      // For each DOM element that has .inputeditable, we add a click event, using inputeditableEnabled(). Which can be used anywhere
      $(".inputeditable").each(function () {
        inputeditableEnabled($(this));
      });

      // This function store the HTML, add child with input. When input lose focus, we push back the value of the input,
      // el is the dom object edited
      function inputeditableEnabled(el) {
        var contentWidth = el.width();
        var contentHeight = el.height();
        el.click(function () {
          var content = el.html().replace(/\n/g, "");
          el.html("").append(inputeditable);
          el.off("click");
          el.width(contentWidth).height(contentHeight);
          el.find(".input").val(content).focus();
          autosize(el.find(".input"));
          el.find(".input").focusout(function () {
            inputeditableDisabled(el, $(this));
          });
        });
      }

      // This function disable the edition of input. It change back the html of .inputeditable to plain text and remove the input
      // ,el is the editable dom object that need to be disabled
      // ,elInput is the input of said object
      function inputeditableDisabled(el, elInput) {
        if (!elInput) {
          elInput = el.find(".input");
        }
        var inputval = elInput.val();
        el.html(inputval);
        el.css({ width: "", height: "auto" });
        inputeditableEnabled(el);
      }

      // Every piece of code can be minified, but I chose not to, for editing purposes.
      // we use autoresize.js but it is not necessary if you have your own textarea resize. You can find the script here https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js
      // if you want the text to be inline, use an input, no textarea
    </script>
    <!--script>
 var modal = document.querySelector(".modal");
// var trigger = document.querySelector(".trigger");
var closeButton = document.querySelector(".close-button");

function toggleModal() {
    modal.classList.toggle("show-modal");
}

function windowOnClick(event) {
    if (event.target === modal) {
        toggleModal();
    }
}

//trigger.addEventListener("click", toggleModal);
closeButton.addEventListener("click", toggleModal);
window.addEventListener("click", windowOnClick);

    </script-->

    <style>
/* reset */
body,p,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dt,dd,table,th,td,form,fieldset,legend,input,textarea,button,select{margin:0;padding:0} 
body,input,textarea,select,button,table{font-family:ng,'Malgun Gothic','맑은고딕','Apple SD Gothic Neo',Dotum,'돋음',sans-serif;font-size:14px;color:#282828;line-height:1;letter-spacing:-.5px;word-break:break-all} 
img,fieldset{border:0} 
ul,ol{list-style:none} 
em,address{font-style:normal} 
a{text-decoration:none} 
a:hover,a:active,a:focus{text-decoration:none}
table{width:100%;/*border-collapse:collapse;*/border-spacing:0}
label{vertical-align:middle}
textarea{resize:none}
fieldset,li,img{border:0;vertical-align:top}
address,caption,em{font-style:normal}
h1,h2,h3,h4,h5,h6{font-weight:normal}
button{
  overflow:visible;
  border:0;
  /*outline:none;*/background-color:transparent;cursor:pointer}
button::-moz-focus-inner{padding:0;border:0}
.blind,legend{overflow:hidden;position:absolute;top:0;left:0;width:1px;height:1px;font-size:1px;
line-height:100px;white-space:nowrap}
/* reset */

.btn_com {  
  background-color:#1C2087;
  color:#fff;
  border-radius: 6px 6px 6px 6px;
  }
.ly_wrap {
  z-index:50;
  position:fixed;
  top:0;
  right:0;
  bottom:0;
  left:0;
  background-color:rgba(0,0,0,0.8);
 }
.ly_box{
  position:absolute;
  top:50%;
  left:50%;
  width:81%;
  height: 70%;
  padding:50px 20px 20px;
  background-color:#fff;
  background-size: auto 100%;
  background-repeat: no-repeat;
  background-image: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-4.png?v=1673256067927");
  transform:translate(-50%,-50%);
  text-align:center;
      }
.ly_box p{font-size:20px;}
.ly_box .btn_close
      {
        position: absolute;
        width:35%;
        height:50px;
        margin-top:20px;
        background-color:#1C2087;
        top: 80%;
        left: 53%;
      }
      
 .ly_box .DecoButton_1
      {
        position: absolute;
        color: white;
        width: 35%;
        height:50px;
        margin-top:20px;
        background-color:#1C2087;
        top: 80%;
        left: 15%;
      }

.btn_popup{
  position: absolute;
  padding:20px;
  left: 50%;
  height: 8%;
  width: 20%;
  top: 80%;
  z-index: 99999;
  }
 .container .btn_close
      {
        position: absolute;
        width:100px;
        height:50px;
        margin-top:30px;
        background-color:#1C2087;
        top: 85%;
        left: 40%;
      } 


      
.btn_container{
  position: absolute;
  padding:20px;
  width: 20%;
  height: 8%;
  left: 25%;
  top: 80%;
  z-index: 99999;
  }
textarea {
  margin-top: 25%;
  margin-left: 1%;
  width: 250px;
  height: 280px;
  -moz-border-bottom-colors: none;
  -moz-border-left-colors: none;
  -moz-border-right-colors: none;
  -moz-border-top-colors: none;
  background: none repeat scroll 0 0 rgba(0, 0, 0, 0.07);
  border-color: -moz-use-text-color #FFFFFF #FFFFFF -moz-use-text-color;
  border-image: none;
  border-radius: 6px 6px 6px 6px;
  border-style: none solid solid none;
  border-width: medium 1px 1px medium;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12) inset;
  color: #555555;
  font-family: "AppleSDGothicNeoM";
  font-size: 1em;
  line-height: 1.4em;
  padding: 5px 8px;
  transition: background-color 0.2s ease 0s;
  white-space: pre-wrap !important;
 
}


textarea:focus {
    background: none repeat scroll 0 0 #FFFFFF;
    outline-width: 0;
}
      
 .container {
          
     z-index:50;
  position:fixed;
  top:0;
  right:0;
  bottom:0;
  left:0;
  background-color:rgba(0,0,0,0.8);     
          
        }     
      
    </style>
    <style>
       /*
  The grid itself needs only 4 CSS declarations:
*/
      @media only screen and (max-width: 700px) {
        
/*
        .myGallery {
          display: grid;
          grid-gap: 20px;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }

        .myGallery img {
          width: 100%;
          height: 150px;
          border-radius: 10px;
        }
        */

        /*
  And here are some declarations for the image caption.
  Just hover over one of the last 5 images to see it.
*/

        .myGallery .item {
          position: relative;
          overflow: hidden;
        }

        .myGallery .item img {
          vertical-align: middle;
          border-radius: 10px;
        }

        .myGallery .caption {
          margin: 0;
          padding: 1em;
          position: absolute;
          z-index: 1;
          bottom: 0;
          left: 0;
          width: 100%;
          max-height: 100%;
          overflow: auto;
          box-sizing: border-box;
          transition: transform 0.5s;
          transform: translateY(100%);
          background: rgba(0, 0, 0, 0.7);
          color: rgb(255, 255, 255);
        }

        .myGallery .item:hover .caption {
          transform: translateY(0%);
        }
       
         .box-1 {
          margin: 0;
          width: 100%;
          height: 10%;
          background: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/disney100-%EA%B0%80%EB%A1%9C.png?v=1670639834306");
          background-position: center;
          background-repeat: no-repeat;
          background-size: contain;
          justify-content: center;
          align-items: center;
        }
      }
      
     .myGallery {
          display: grid;
          grid-gap: 20px;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
      .myGallery img {
         border: solid 10px;
          width: 100%;
          height: 120px;
          border-radius: 10px;
        object-fit: cover;
        cursor: pointer;
      }
      .myGallery img.selected {
        border-color: green;
      } 
      
            .HomeButton {
        background-color: transparent;
        background-image: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/%EB%92%A4%EB%A1%9C%EA%B0%80%EA%B8%B0.png?v=1672667294936");
        background-size: cover;
        background-position: center;
        border: none;
        padding: 5px;
        display: inline-block;
        margin: 1px 1px;
        cursor: pointer;
        border-radius: 50%;
        position: fixed;
        top: 1%;
        left: 1%;
        width: 65px;
        height: 65px;
        /*display: flex;*/
        justify-content: center;
        align-items: center;
        z-index: 99999;
        transition: all 0.5s;
        cursor: pointer;
      }
      .HomeButton:hover {
        background-color: Gold;
      }
      .WriteButton {
        background-color: transparent;
        background-image: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/%ED%8E%B8%EC%A7%80%EC%93%B0%EA%B8%B0.png?v=1672667303909");
        background-size: cover;
        background-position: center;
        border: none;
        padding: 5px;
        display: inline-block;
        margin: 1px 1px;
        cursor: pointer;
        border-radius: 50%;
        position: fixed;
        top: 90%;
        left: 82%;
        width: 65px;
        height: 65px;
        /*display: flex;*/
        justify-content: center;
        align-items: center;
        z-index: 99999;
        transition: all 0.5s;
        cursor: pointer;
        display: none;
      }
      .WriteButton:hover {
        background-color: Gold;
      }
      .DecoButton {
        background-color: transparent;
        background-image: url("https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/%EC%8A%A4%ED%8B%B0%EC%BB%A4.png?v=1672667296489");
        background-size: cover;
        background-position: center;
        border: none;
        padding: 5px;
        display: inline-block;
        margin: 1px 1px;
        cursor: pointer;
        border-radius: 50%;
        position: fixed;
        top: 90%;
        left: 65%;
        width: 65px;
        height: 65px;
        /*display: flex;*/
        justify-content: center;
        align-items: center;
        z-index: 99999;
        transition: all 0.5s;
        cursor: pointer;
        display: none;
      }
      .DecoButton:hover {
        background-color: Gold;
      }
      
      .DecoButton_container{
  position: absolute;
  padding:20px;
  width: 20%;
  height: 8%;
  left: 25%;
  top: 80%;
  z-index: 99999;
  }
      

      .is-visible .bts-popup-container {
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -ms-transform: translateY(0);
  -o-transform: translateY(0);
  transform: translateY(0);
}
 /*   
      .myGallery {
        position: fixed;
        left: 0px;
        top: 150px;
        z-index: 2;
      }
      .myGallery img {
        border: solid 2px;
        width: 100px;
        height: 100px;
        object-fit: cover;
        cursor: pointer;
      }
      .myGallery img.selected {
        border-color: green;
      }
      */
       #stampMsg {
        position: absolute;

        left: 20%;
        top: 20%;
        width: 55%;

        display: none;
      }
    </style>
    <style>


table, th, td {
  border: solid 0px #000;
  padding: 10px;
}

table {
    border-collapse:collapse;
}

    </style>
        
  </head>
  <body>
        <button
      class="HomeButton"
      id="home-btn"
      onclick="window.open('https://abc-portal.glitch.me/letter-1.html','_self');"
    ></button>
<button id="w-popup" type="button" class="WriteButton btn_popup" role="alert"></button>
<button type="button" class="DecoButton btn_container"></button>
    
<div class="ly_wrap" id="MsgZone">
  <div class="ly_box" id="ly_box">
    <p>
      <!--textarea placeholder="여기에 사연을 적으세요." rows="20" name="comment[text]" id="fname" cols="40" class="ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true"></textarea-->
     <textarea placeholder="여기에 사연을 적으세요." maxlength="150" rows="10" name="comment[text]" id="fname" row="3" cols="20" wrap="hard" class="ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true"></textarea>

    </p>
    <table>
	<tbody>
      <tr>
        <th><button type="button" onclick="$('.container').show();" class="DecoButton_1 btn_com"><h3>편지지 꾸미기</h3></button></th>
        <th><button type="button" onclick="ee()" class="btn_close btn_com" id="Close"><h3>작성완료</h3></button></th>     
      </tr>
  </tbody>
</table>
  </div>
  </div>

   
<div class="container" id="sticker" style="display:none">
   <p>&nbsp</p>
      <div class="box-1"></div>
      <p>나만의 스티커를 골라 편지지를 꾸미세요.</p>
      <h1>스티커 고르기</h1>
      <div class="myGallery">
          <img
            id="hat1"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-love-you%20(1).gif?v=1671504586809"
          />
          <img
            id="hat2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-thank-you.gif?v=1671504580622"
          />
          <img
            id="glasses1"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-please.gif?v=1671505392479"
          />
          <img
            id="glasses2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-nice.gif?v=1671505394647"
          />

          <img
            id="helmet"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-ok.gif?v=1671504588534"
          />
          <img
            id="helmet2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-haha.gif?v=1671504585085"
          />
        <p> <button type="button" class="btn_close btn_com" id="DecoClose"><h3>선택완료</h3></button></p>   
      </div>
        
    </div>
    <a-scene
      vr-mode-ui="enabled: false"
      loading-screen="enabled: false"
      device-orientation-permission-ui="enabled: false"
      renderer="antialias: true; logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true;"
      arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
    >
    
      <a-entity camera="active: true" look-controls wasd-controls position="0 0 5" data-aframe-default-camera></a-entity>
            <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/37bKDFsxEN3YPuO223/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="-1 0.6 -3"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"             
        class="hat1-entity"
        visible="false"
      ></a-plane>

      <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/fZ4jDs5mvanngKVT5v/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="1 0.6 -3"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"       
        class="hat2-entity"
        visible="false"
      ></a-plane>
            <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/WQCuv3DugIBVcJQXsw/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="1 -0.85 -3"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"             
        class="helmet-entity"
        visible="false"
      ></a-plane>
                  <!--a-image 
              material="shader:gif; src: url(https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/m-thank-you.gif?v=1671504580622); opacity: 1; alphaTest: 0.5; side: double;"
              position="-1 -0.5 -3"
              scale="-0.5 -0.5 0.5"
                           rotation="180 0 0"
                           class="helmet2-entity"
                     ></a-image-->
                  <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/aKQxx0NfYUDsY/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="-1 -0.85 -3"
        rotation="0 0 0"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"                   
        class="helmet2-entity"
        visible="false"
      ></a-plane>
                        <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/VT9QLGJyS1irdRTqrB/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="0 0.6 -3"
        rotation="0 0 0"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"                         
        class="glasses1-entity"
        visible="false"
      ></a-plane>
                        <a-plane
        material="shader:gif; src: url(https://media.giphy.com/media/GfPBZIfawO10zfisPt/giphy.gif); opacity: 1; alphaTest: 0.5; side: double;"
        position="0 -0.85 -3"
        rotation="0 0 0"
        color="white"
        scale="0.7 0.5 0.7"
        curve-radius="40"
        class="glasses2-entity"
        visible="false"
      ></a-plane>
      
      <a-entity>
        <a-troika-text
          id="output"
          position="0 -0.15 -3.8"
          color="#fff"
          max-width="5"
          curve-radius="40"
          scale="0.6 0.4 0.6"

          font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/AppleSDGothicNeoM.ttf?v=1671085239370"
          value="디즈니 100주년 기념 사연을 적어보세요"

        ></a-troika-text>

        <!--a-plane
          position="0 -0.2 -3.9"
          height="2.1"
          width="3.3"
          curve-radius="40"
  
          material="src: https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/mickeymoon-100.png?v=1670561714724; color: #ffffff; roughness: 1; metalness: 0"
          animation="property: scale; to: 0 0 0; delay: 4000; dur: 4000; easing: linear; loop: false"
        ></a-plane-->
                          <!--a-image 
              src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/mickeymoon-100.png?v=1670561714724" 
              position="0 -0.2 -3.9"
              scale="0.3 0.2 0.3"
              material="opacity: 0.3; transparent: true"
              animation="property: scale; to: 0 0 0; delay: 4000; dur: 4000; easing: linear; loop: false"
                     ></a-image-->
        <!--a-plane
          position="0 -0.2 -4"
          height="2"
          width="3.15"
          curve-radius="40"
          color="#E64C3C"

          material="opacity: 0.3; transparent: true; src: https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-1.png?v=1670487397403; color: #ffffff; roughness: 1; metalness: 0"
          animation="property: postion; to: 0 0 0; delay: 2000; dur: 2000; easing: linear; loop: false"
        ></a-plane-->
          <a-image 
              position="0 -0.1 -4"
              height="2.1"
              width="3.15"
              material="opacity: 0.4; transparent: true"
              src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-4.png?v=1673256067927"
                     ></a-image>
      
      </a-entity>
      <a-entity
        text="value: some text; wrapCount: 20; width: 3"
        position="0 2 0"
        my-test-component
      ></a-entity>

      <!--<a-text
        position="0 1.1 -2"
        value="Hello a-text for comparison!"
      ></a-text>
<a-camera active="false" position="0 1.6 -3"></a-camera>
          <!--a-light type="ambient" intensity="3.3"></a-light-->
    </a-scene>
    <!--div class="helmet2-entity">
      <img id="stampMsg" />
    </div-->
   <button
          class="capturebtn"
          id="capture"
          style="vertical-align: middle"
        ></button>
        <button
          class="savebtn"
          id="save"
          style="vertical-align: middle"
        ></button>
        <!-- The Modal -->
        <div id="myModal" class="modal" align="center">
          <!-- Modal content -->
          <div>
            <img class="modal-content" id="img01" />
            <span class="closebtn">
              <img
                src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/close-white.png?v=1670812239754"
                width="30px"
                height="30px"
              />
            </span>
            <div id="caption"></div>
          </div>
        </div>
     

    <script type="text/javascript" src="hmodal_active.js"></script>
    <script type="text/javascript" src="capture-1.js"></script>
   
       
    
<script>
    $('.btn_popup').click(function(){      
      $('.ly_wrap').show();
       $('.DecoButton').hide();
        $('.capturebtn').hide();    
        $('.WriteButton').hide(); 
      
})
      
 $('.btn_container').click(function(){
  $('.container').show(); 
   $('.DecoButton').hide();
        $('.capturebtn').hide();    
        $('.WriteButton').hide(); 
})     
 $('#DecoClose').click(function(){
  $('.container').hide(); 
  var tt = document.getElementById("MsgZone");
   if (tt.style.display == "none") {
   $('.DecoButton').show();
        $('.capturebtn').show();    
        $('.WriteButton').show(); 
   }
   else {
     $('.DecoButton').hide();
        $('.capturebtn').hide();    
        $('.WriteButton').hide(); 
   }
})
</script>

  </body>
</html>
