<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A-Frame test component Component - Basic</title>
    <meta
      name="description"
      content="Basic example for troika-text component."
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="aframe-troika-text.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const list = [
          "glasses1",
          "glasses2",
          "hat1",
          "hat2",
          "helmet",
          "helmet2",
        ];
        const visibles = [true, true, true, true, true, true];
        const setVisible = (button, entities, visible) => {
          if (visible) {
            button.classList.add("selected");
          } else {
            button.classList.remove("selected");
          }
          entities.forEach((entity) => {
            entity.setAttribute("visible", visible);
          });
        };
        list.forEach((item, index) => {
          const button = document.querySelector("#" + item);
          const entities = document.querySelectorAll("." + item + "-entity");
          setVisible(button, entities, visibles[index]);
          button.addEventListener("click", () => {
            visibles[index] = !visibles[index];
            setVisible(button, entities, visibles[index]);
          });
        });
      });
    </script>
    <script>
      AFRAME.registerComponent("my-test-component", {
        tick: function () {
          var el = this.el;
          el.setAttribute("text", { value: "" });
        },
      });

      function ee() {
        document
          .getElementById("output")
          .setAttribute("value", document.getElementById("fname").value);
      }
    </script>
    <script>
      // You can set the input as you want
      var inputeditable =
        '<textarea contenteditable="true" type="text" name="" class="input">';

      // For each DOM element that has .inputeditable, we add a click event, using inputeditableEnabled(). Which can be used anywhere
      $(".inputeditable").each(function () {
        inputeditableEnabled($(this));
      });

      // This function store the HTML, add child with input. When input lose focus, we push back the value of the input,
      // el is the dom object edited
      function inputeditableEnabled(el) {
        var contentWidth = el.width();
        var contentHeight = el.height();
        el.click(function () {
          var content = el.html().replace(/\n/g, "");
          el.html("").append(inputeditable);
          el.off("click");
          el.width(contentWidth).height(contentHeight);
          el.find(".input").val(content).focus();
          autosize(el.find(".input"));
          el.find(".input").focusout(function () {
            inputeditableDisabled(el, $(this));
          });
        });
      }

      // This function disable the edition of input. It change back the html of .inputeditable to plain text and remove the input
      // ,el is the editable dom object that need to be disabled
      // ,elInput is the input of said object
      function inputeditableDisabled(el, elInput) {
        if (!elInput) {
          elInput = el.find(".input");
        }
        var inputval = elInput.val();
        el.html(inputval);
        el.css({ width: "", height: "auto" });
        inputeditableEnabled(el);
      }

      // Every piece of code can be minified, but I chose not to, for editing purposes.
      // we use autoresize.js but it is not necessary if you have your own textarea resize. You can find the script here https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js
      // if you want the text to be inline, use an input, no textarea
    </script>
    <style>
      body {
        margin: 10px;
      }
      .example-container {
        overflow: hidden;
        position: absolute;
        width: 100%;
        height: 100%;
      }
      .options-panel {
        position: fixed;
        left: 0px;
        top: 150px;
        z-index: 2;
      }
      .options-panel img {
        border: solid 2px;
        width: 100px;
        height: 100px;
        object-fit: cover;
        cursor: pointer;
      }
      .options-panel img.selected {
        border-color: green;
      }
    </style>
    <style>
      #wrapper {
        overflow: hidden;
        position: absolute;
        top: 30px;
        left: 10px;
        width: 10px;
        height: 10px;
        font-size: 1px;
        line-height: 0px;
        white-space: nowrap;
      }     
      form {
        position: absolute;
        height: 10%;
        left: 0%;
        top: 8%;
        width: 100%;
        z-index: 1;
        padding: 1em;
      }
      button {
        position: absolute;
        top: 10%;
        left: 80%;
        z-index: 1;
      }
      body {
        color: white;
      }
      input {
        width: 300px;
        height: 100px;
        font-size: 20px;
      }
    </style>
    <!--style>
      /* You can edit this easily and make it suit your project. I strongly advice to edit the white-space property to fit your project. */

      .inputeditable {
        position: relative;
        cursor: text;
        transition: background-color 0.5s;
        border-radius: 8px;
        border: none;
        box-shadow: 0px 0px 0px 1.5px #ffffff;
      }
      .inputeditable:hover {
        background-color: #f4f5f6;
      }
      .inputeditable .input {
        resize: none;
        position: absolute;
        width: 100%;
        height: 100%;
        font-size: inherit;
        box-sizing: border-box;
        background: none;
        outline: none;
        background-color: #ffffff;
        top: 0px;
        left: 0;
        padding-left: inherit;
        padding-right: inherit;
        padding: inherit;
        border-radius: 8px;
        font-family: inherit;
        box-shadow: 0px 0px 0px 1.5px #0ebeff;
        border: none;
        word-wrap: break-word;
        font-weight: inherit;
        line-height: inherit;
        letter-spacing: inherit;
        color: inherit;
      }

      /* style related to this pen, do not copy */
      wrapper {
        position: absolute;
        height: 100%;
        width: 100%;
        font-family: Open sans;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      wrapper p {
        font-size: 24px;
        padding: 4px 10px;
        width: 600px;
        /*white-space: nowrap;*/
      }

      body,
      html {
        margin: 0;
        padding: 0;
      }
      content {
        height: 100px;
      }
    </style-->
    <style>
      /* reset */
      body,
      p,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      ul,
      ol,
      li,
      dl,
      dt,
      dd,
      table,
      th,
      td,
      form,
      fieldset,
      legend,
      input,
      textarea,
      button,
      select {
        margin: 0;
        padding: 0;
      }
      body,
      input,
      textarea,
      select,
      button,
      table {
        font-family: ng, "Malgun Gothic", "맑은고딕", "Apple SD Gothic Neo",
          Dotum, "돋음", sans-serif;
        font-size: 14px;
        color: #282828;
        line-height: 1;
        letter-spacing: -0.5px;
        word-break: break-all;
      }
      img,
      fieldset {
        border: 0;
      }
      ul,
      ol {
        list-style: none;
      }
      em,
      address {
        font-style: normal;
      }
      a {
        text-decoration: none;
      }
      a:hover,
      a:active,
      a:focus {
        text-decoration: none;
      }
      table {
        width: 100%; /*border-collapse:collapse;*/
        border-spacing: 0;
      }
      label {
        vertical-align: middle;
      }
      textarea {
        resize: none;
      }
      fieldset,
      li,
      img {
        border: 0;
        vertical-align: top;
      }
      address,
      caption,
      em {
        font-style: normal;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: normal;
      }
      button {
        overflow: visible;
        border: 0; /*outline:none;*/
        background-color: transparent;
        cursor: pointer;
      }
      button::-moz-focus-inner {
        padding: 0;
        border: 0;
      }
      .blind,
      legend {
        overflow: hidden;
        position: absolute;
        top: 0;
        left: 0;
        width: 1px;
        height: 1px;
        font-size: 1px;
        line-height: 100px;
        white-space: nowrap;
      }
      /* reset */

      .btn_com {
        background-color: #256b9a;
        color: #fff;
      }
      .ly_wrap {
        z-index: 10;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        background-color: rgba(0, 0, 0, 0.8);
      }
      .ly_box {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 400px;
        height: 300px;
        padding: 50px 20px 20px;
        background-color: #fff;
        transform: translate(-50%, -50%);
        text-align: center;
      }
      .ly_box p {
        font-size: 14px;
      }
      .ly_box .btn_close {
        width: 100px;
        height: 100px;
        margin-top: 30px;
        background-color: #256b9a;
      }
      .btn_popup {
        padding: 20px;
      }
    </style>
    <style>
       /*
  The grid itself needs only 4 CSS declarations:
*/

.myGallery {
  display: grid;
  grid-gap: 10px;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
}

.myGallery img {
  width: 100%;
}

/*
  And here are some declarations for the image caption.
  Just hover over one of the last 5 images to see it.
*/

.myGallery .item {
  position: relative;
  overflow: hidden;
}

.myGallery .item img {
  vertical-align: middle;
}

.myGallery .caption {
  margin: 0;
  padding: 1em;
  position: absolute;
  z-index: 1;
  bottom: 0;
  left: 0;
  width: 100%;
  max-height: 100%;
  overflow: auto;
  box-sizing: border-box;
  transition: transform 0.5s;
  transform: translateY(100%);
  background: rgba(0, 0, 0, 0.7);
  color: rgb(255, 255, 255);
}

.myGallery .item:hover .caption {
  transform: translateY(0%);
}

/*
  The rest is only styling for this example page
*/

@import url("https://fonts.googleapis.com/css2?family=Vollkorn:wght@400;900&display=swap");

body {
  font: 400 1.5em/1.58 Vollkorn, serif;
}

h1,
p {
  text-align: center;
}

.myGallery {
  font-size: 1rem;
}

    </style>
  </head>
  <body>
    <div class="ly_wrap" style="display: none">
      <div class="ly_box">
        <p>
              <form name="myForm">
      사연적기: <!--input type="text" value="" name="fname" id="fname" /-->
                <textarea id="fname" onclick="ee()" name="fname" rows="4" cols="50" maxlength="50">

</textarea>
    </form>
    <button onclick="ee()" style="display:block; margin: 0 auto; text-align: right">글쓰기</button>   
          <wrapper>
            <content>
              <p class="inputeditable" name="foo">
                사연을 적고 아래의 템플릿 중 하나를 선택해서 나만의 AR레터를 만들어 보세요.
              </p>
            </content>
          </wrapper>
  
         <div id="wrapper">
      <div class="example-container">
        <div class="options-panel">
          <img
            id="hat1"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/walts-sharks.png?v=1658124253472"
          />
          <img
            id="hat2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/fishes-particles.png?v=1658124200148"
          />
          <img
            id="glasses1"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/tropical-fishes.png?v=1658124254092"
          />
          <img
            id="glasses2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/jellyfishes.png?v=1670403612952"
          />

          <img
            id="helmet"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/school-fishes.png?v=1670403614013"
          />
          <img
            id="helmet2"
            src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/Octopus.png?v=1670403615213"
          />
        </div>
        
           </div>
        </div>

        </p>
        <button type="button" class="btn_close btn_com">팝업 닫기</button>
      </div>
    </div>
    <button type="button" class="btn_popup btn_com">레이어 팝업 열기</button>
   
 

        <a-scene
          vr-mode-ui="enabled: false"
          device-orientation-permission-ui="enabled: false"
          arjs
        >
          <!--a-entity
          id="scene1"
          scale="5 5 5"
          position="0 2 -1"
          rotation="0 0 0"
          gltf-model="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/bat-cute.glb?v=1658986652419"
          shadow="receive: true"
          animation-mixer
          gesture-handler
          animation="property: rotation; dur: 10000;
                       to: 0 360 0; loop: true"
          animation__2="property: position; dur: 15000;
                       to: -1.5 1.7 -10; loop: false"
          class="clickable"
          event-set__enter="_event: mousedown"
          navigate-on-click="url: https://www.baeulang.kr"
        >
        </a-entity-->
          <a-assets>
            <a-asset-item
              id="headModel"
              src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/examples/face-tracking/assets/sparkar/headOccluder.glb"
            ></a-asset-item>

            <a-asset-item
              id="glassesModel"
              src="https://cdn.glitch.me/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/tropical-fishes.glb?v=1658122336365"
            ></a-asset-item>
            <a-asset-item
              id="glassesModel2"
              src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/beating_heart%20(1).glb?v=1670511696120"
            ></a-asset-item>

            <a-asset-item
              id="hatModel"
              src="https://cdn.glitch.global/84219226-bfa8-4881-9a68-88e43606a2ce/confettiv2.glb?v=1668304368875"
            ></a-asset-item>

            <a-asset-item
              id="hatModel2"
              src="https://cdn.glitch.me/84219226-bfa8-4881-9a68-88e43606a2ce/ginger_cookie_shrek.glb?v=1669712200575"
            ></a-asset-item>
            <a-asset-item
              id="whale"
              src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/blue-whale.glb?v=1661216831738"
            ></a-asset-item>
            <a-asset-item
              id="helmetModel"
              src="https://cdn.glitch.global/84219226-bfa8-4881-9a68-88e43606a2ce/candy_cane%20(3).glb?v=1669712123697"
            ></a-asset-item>
            <a-asset-item
              id="helmetModel2"
              src="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/love_neon_sign_-_wall.glb?v=1670512066611"
            ></a-asset-item>
          </a-assets>
          <a-camera active="false" position="0 1.6 -3"></a-camera>
          <!--a-entity>
            <a-gltf-model
              mindar-face-occluder
              position="0 -0.3 0.15"
              rotation="0 0 0"
              scale="0.065 0.065 0.065"
              src="#headModel"
            ></a-gltf-model>
          </a-entity-->

          <!--a-entity mindar-face-target="anchorIndex: 10">
          <a-gltf-model
            rotation="0 -180 0"
            position="0 -0.35 -0.6"
            scale="0.00073 0.00073 0.00073"
            src="#hatModel"
            class="hat1-entity"
            visible="false"
          ></a-gltf-model>
        </a-entity-->
          <a-entity>
            <a-gltf-model
              rotation="0 0 0"
              position="0 -0.35 -5.6"
              scale="2.7 2.7 2.7"
              src="#hatModel"
              class="hat1-entity"
              visible="false"
              animation-mixer
            ></a-gltf-model>
          </a-entity>
          <!--a-entity mindar-face-target="anchorIndex: 10">
          <a-gltf-model
            rotation="0 -180 0"
            position="0 -0.35 -0.6"
            scale="0.00073 0.00073 0.00073"
            src="#hatModel2"
            class="hat2-entity"
            visible="false"
          ></a-gltf-model>
         </a-entity-->
          <a-entity>
            <a-gltf-model
              rotation="0 -20 0"
              position="0.7 2.2 -2"
              scale="0.1 0.1 0.1"
              src="#hatModel2"
              class="hat2-entity"
              visible="false"
              animation-mixer
              animation="property: position; to: 0.7 2.1 -2; dur: 8000; easing: linear; loop: true"
            ></a-gltf-model>
          </a-entity>

          <a-entity>
            <a-gltf-model
              rotation="0 -0 0"
              position="0 1.8 -3.1"
              scale="0.75 0.75 0.75"
              src="#glassesModel"
              class="glasses1-entity"
              visible="false"
              animation-mixer
            ></a-gltf-model>
          </a-entity>

          <a-entity>
            <a-gltf-model
              rotation="0 0 0"
              position="-0.7 2.1 -2"
              scale="0.2 0.2 0.2"
              src="#glassesModel2"
              class="glasses2-entity"
              visible="false"
              animation-mixer
    
            ></a-gltf-model>
          </a-entity>

          <a-entity>
            <a-gltf-model
              rotation="0 90 0"
              position="-0.5 0.8 -2"
              scale="0 0 0"
              src="#helmetModel"
              class="helmet-entity"
              visible="false"
              animation-mixer
              animation="property: position; to: -0.6 0.9 -2; dur: 3000; easing: linear; loop: false"
              animation__2="property:scale; to: 0.0002 0.0002 0.0002; dur: 3000; easing: linear; loop: false"
            ></a-gltf-model>
          </a-entity>

          <a-entity>
            <a-gltf-model
              rotation="0 40 0"
              position="1 0.6 -2.5"
              scale="0.9 0.9 0.9"
              src="#helmetModel2"
              class="helmet2-entity"
              visible="false"
              animation-mixer
              animation="property: position; to: 1 0.7 -2.5; dur: 3000; easing: linear; loop: false"
            ></a-gltf-model>
          </a-entity>
          <a-troika-text
            position="1.5 2.5 -3.9"
            rotation="180 0 0"
            color="#fff"
            max-width="10"
            curve-radius="3"
            font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/wingding.ttf?v=1658499304585"
            scale="5 5 5"
            value="E"
          ></a-troika-text>
          <a-entity>
            <a-troika-text
              id="output"
              position="0 1.9 -3.8"
              color="#000"
              max-width="15"
              curve-radius="0"
              scale="0 0 0"
              font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/KOTRA_SONGEULSSI.ttf?v=1670540917006"
              value="디즈니100주년 기념"
              animation="property: scale; to: 0.6 0.6 0.6; delay: 2000; dur: 5000; easing: linear; loop: false"
              animation__2="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
            ></a-troika-text>

            <!--a-troika-text
              position="0 1.3 -4"
              color="#000"
              max-width="7"
              curve-radius="0"
              scale="0.5 0.5 0.5"
              font="https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/Ghanachocolate.ttf?v=1658802278705"
              value="클릭하면 오디오가이드를 들을 수 있습니다."
            ></a-troika-text-->
            <a-plane
              position="0 1.7 -4.1"
              height="2.55"
              width="3.1"
              curve-radius="0"
              rotation="0 0 0"
              animation="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
            ></a-plane>
            <a-plane
              position="0 1.7 -4"
              height="2.45"
              width="2.95"
              curve-radius="0"
              color="#E64C3C"
              rotation="0 0 0"
              material="src: https://cdn.glitch.global/3d3ecbaf-67a2-4d22-b8ec-ad23b8be5288/MYmessage10-1.png?v=1670487397403; color: #ffffff; roughness: 1; metalness: 0"
              animation="property: rotation; to: 0 360 -5; dur: 5000; easing: linear; loop: false"
            ></a-plane>
          </a-entity>

          <a-entity
            text="value: some text; wrapCount: 20; width: 3"
            position="0 2 0"
            my-test-component
          ></a-entity>

          <!--<a-text
        position="0 1.1 -2"
        value="Hello a-text for comparison!"
      ></a-text>
<a-camera active="false" position="0 1.6 -3"></a-camera>
          <!--a-light type="ambient" intensity="3.3"></a-light-->
        </a-scene>

    <script>
      $(".btn_popup").click(function () {
        $(".ly_wrap").show();
      });

      $(".btn_close").click(function () {
        $(".ly_wrap").hide();
      });
    </script>
  </body>
</html>
